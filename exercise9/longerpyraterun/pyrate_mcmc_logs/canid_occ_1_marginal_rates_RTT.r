# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb274/labwork/exercise9/longerpyraterun/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb274/labwork/exercise9/longerpyraterun/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.153242952188, 0.153242952188,0.153242952188,0.153506957096,0.150004582162,0.0710487473474,0.0460922045516,0.0374696227866,0.0381367121226,0.0402755124573,0.0408895599649,0.0408895599649,0.0408895599649,0.0408895599649,0.0402755124573,0.0399933889697,0.0412261403847,0.0537815908396,0.0629460969472,0.0673758408412,0.0716331152029,0.0840067241949,0.103262443463,0.104254900531,0.107326336929,0.107326336929,0.107326336929,0.104254900531,0.104905359845,0.103262443463,0.0960545625733,0.115560463525,0.130064412204,0.131450385168,0.135300069232,0.134086891523,0.135300069232,0.134209049459,0.134086891523,0.131206880697,0.134086891523,0.134086891523,0.129662985086,0.131206880697,0.131206880697,0.133596344117,0.131206880697,0.131206880697,0.131206880697)
L_hpd_M95=c(0.334278925921, 0.334278925921,0.334278925921,0.334710060364,0.334710060364,0.320334453224,0.274056785636,0.230897274954,0.136547161365,0.135444780971,0.135688994143,0.135444780971,0.135444780971,0.135408514149,0.135444780971,0.140062631156,0.163358717854,0.182993603215,0.189959196676,0.195178739548,0.200683515375,0.212554587508,0.22716014528,0.220896406229,0.222352247411,0.222352247411,0.222976233325,0.220896406229,0.226183097385,0.243651863133,0.276108040644,0.374380825124,0.404536514891,0.410855734865,0.421264704962,0.418777008745,0.421432133676,0.421264704962,0.421264704962,0.422685053657,0.431222924571,0.440819754773,0.443308538165,0.449697695272,0.454327834688,0.462018422146,0.462889925163,0.462889925163,0.462889925163)
M_hpd_m95=c(0.938283395755, 0.938283395755,0.0873830271906,0.0873830271906,0.0873830271906,0.0872451260185,0.0873830271906,0.0873830271906,0.0882514560649,0.0885437668264,0.0885437668264,0.0885437668264,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0882514560649,0.0881544651659,0.0873830271906,0.0873830271906,0.0873830271906,0.0873830271906,0.0873830271906,0.0873830271906,0.0873830271906)
M_hpd_M95=c(1.55729582778, 1.55729582778,0.12611055313,0.125676084251,0.12560679795,0.125402782267,0.125032577886,0.124855724917,0.12438042714,0.12438042714,0.12438042714,0.12438042714,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123867836279,0.123960165953,0.12438042714,0.123827267283,0.123827267283,0.123827267283,0.123827267283,0.123827267283,0.123827267283,0.123827267283)
R_hpd_m95=c(-1.30619069172, -1.30619069172,0.0479317446859,0.0477180489882,0.0455553689906,-0.0373189387493,-0.0683123285436,-0.078305082734,-0.0740030931152,-0.0726138765111,-0.0724609794138,-0.071569989718,-0.0710140695883,-0.0709334194044,-0.071569989718,-0.0736596262175,-0.0682272676191,-0.0577828194811,-0.0464973987158,-0.0414980327464,-0.035024223435,-0.0242256296027,-0.00911795176824,0.000579386454645,-0.0017992518672,-0.0017992518672,0.000579386454645,0.000579386454645,-0.00132143984745,-0.0114977051648,-0.00533080262973,0.00790943387013,0.0229605634505,0.0182432500541,0.0356243086209,0.0354719750327,0.0354719750327,0.0344829023102,0.0325595254891,0.0259550623268,0.0247528591726,0.0257219178287,0.0257219178287,0.021285077874,0.019351141804,0.0212580930564,0.0177461668537,0.0211915511871,0.0211915511871)
R_hpd_M95=c(-0.673960937959, -0.673960937959,0.231376112975,0.231376112975,0.232551119024,0.215785265918,0.171631216692,0.126131999648,0.0364359296587,0.0325496770284,0.0325496770284,0.0325496770284,0.0325496770284,0.0325496770284,0.0325496770284,0.0366394779931,0.0604777685441,0.0787607209893,0.0890990427254,0.0936976689002,0.101228087208,0.110352247709,0.116706868056,0.121054143582,0.117432009283,0.117772987778,0.120733958375,0.121662881932,0.125057988158,0.132928680797,0.176395786968,0.271695567394,0.306675693996,0.306675693996,0.326795525745,0.324509146114,0.326170608934,0.32766836834,0.326170608934,0.322853253625,0.3257277664,0.333792033474,0.341501516392,0.341501516392,0.345137191664,0.353671930687,0.355374554048,0.359439905745,0.359439905745)
L_mean=c(0.250574360424, 0.250574360424,0.250569436214,0.250497800877,0.249822964652,0.232361364971,0.13396164862,0.0970272268285,0.0814686951002,0.0804783607158,0.0804718946748,0.0804441803399,0.0804231784093,0.0803422219598,0.0805950756124,0.0819013752541,0.0949104033347,0.115446692264,0.129943328249,0.134844478514,0.142747030463,0.153314982015,0.159209643116,0.162974506546,0.163783451912,0.163960843243,0.163694747153,0.163749260334,0.165145136727,0.168895554451,0.176958198003,0.223867982223,0.255359098091,0.262189684597,0.271451546464,0.272720433675,0.272946799324,0.27383778371,0.274673496014,0.27432301721,0.275464727666,0.276558042318,0.278278169438,0.278008930414,0.27858465829,0.279123114593,0.279575248141,0.279704612203,0.279710086522)
M_mean=c(1.21244102542, 1.21244102542,0.106388612857,0.106428821169,0.106439847464,0.106395174866,0.106317486345,0.106044179535,0.105731016145,0.105644461627,0.105613455381,0.105615400008,0.105545793682,0.105545793682,0.105545793682,0.105545793682,0.105545793682,0.105545793682,0.105545793682,0.105545793682,0.105545793682,0.105545793682,0.105545793682,0.105545793682,0.105545793682,0.105545793682,0.105545793682,0.105545793682,0.105533226944,0.105533226944,0.105533226944,0.105533226944,0.105533226944,0.105533226944,0.105533226944,0.105533226944,0.105533226944,0.105533226944,0.105533226944,0.105533226944,0.105556172098,0.105613246804,0.105688681127,0.105688681127,0.105688681127,0.105688681127,0.105688681127,0.105688681127,0.105688681127)
R_mean=c(-0.961866664996, -0.961866664996,0.144180823357,0.144068979708,0.143383117188,0.125966190105,0.0276441622755,-0.00901695270637,-0.0242623210452,-0.0251661009114,-0.0251415607064,-0.0251712196685,-0.0251226152729,-0.0252035717224,-0.0249507180698,-0.023644418428,-0.0106353903474,0.00990089858181,0.024397534567,0.0292986848316,0.0372012367808,0.0477691883328,0.0536638494336,0.0574287128635,0.0582376582299,0.0584150495611,0.0581489534713,0.0582034666515,0.0596119097837,0.0633623275073,0.071424971059,0.11833475528,0.149825871147,0.156656457654,0.16591831952,0.167187206731,0.167413572381,0.168304556766,0.16914026907,0.168789790266,0.169908555568,0.170944795514,0.172589488311,0.172320249287,0.172895977163,0.173434433466,0.173886567014,0.174015931076,0.174021405394)
trans=0.5
age=(0:(49-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.509178917679), xlim = c(-51.45,2.45), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.71302541056), xlim = c(-51.45,2.45), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.4368097609, 0.395383896319), xlim = c(-51.45,2.45), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-51.45,2.45), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()