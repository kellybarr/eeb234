# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb274/labwork/exercise9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb274/labwork/exercise9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.14376819585, 0.14376819585,0.14376819585,0.14376819585,0.0985171960638,0.0736882998397,0.0513690623945,0.0602996138929,0.0583988035313,0.0602996138929,0.0602996138929,0.0602996138929,0.0605567998724,0.0605567998724,0.0583988035313,0.0725731089406,0.0663044885425,0.0725731089406,0.0725731089406,0.0736882998397,0.0801590224429,0.0889839295905,0.0924964548947,0.097123936582,0.097123936582,0.097123936582,0.097123936582,0.097123936582,0.0930679946981,0.0889839295905,0.115439107321,0.124741321771,0.124741321771,0.124741321771,0.12541133511,0.12541133511,0.12541133511,0.12541133511,0.140116310775,0.140116310775,0.140116310775,0.140116310775,0.131178742059,0.120428750733,0.120428750733,0.103985747885,0.103985747885,0.103985747885,0.103985747885)
L_hpd_M95=c(0.365907363129, 0.365907363129,0.365907363129,0.369594824813,0.362402604503,0.326129647856,0.188777598258,0.151350981974,0.146615043689,0.146615043689,0.146615043689,0.146615043689,0.146615043689,0.146615043689,0.146615043689,0.163415439566,0.158893313302,0.165532949358,0.176376145878,0.180815333534,0.194966161831,0.207309527194,0.210480134307,0.213994722664,0.213994722664,0.218152190193,0.218152190193,0.219239330681,0.22231842607,0.300040398076,0.356869364607,0.360248478899,0.360248478899,0.360248478899,0.381480273978,0.381480273978,0.381480273978,0.381480273978,0.409404986206,0.409404986206,0.409404986206,0.409404986206,0.409404986206,0.402220358898,0.429046057833,0.429046057833,0.429046057833,0.429046057833,0.429046057833)
M_hpd_m95=c(0.831697627154, 0.831697627154,0.0955422346982,0.0955422346982,0.0939219850121,0.0955422346982,0.0965739334402,0.0965739334402,0.0965739334402,0.0939219850121,0.0963162872141,0.0965739334402,0.0985392987671,0.0973417538372,0.0963162872141,0.0973417538372,0.0973417538372,0.0973417538372,0.0963162872141,0.0973417538372,0.0963162872141,0.089777448342,0.0623950676658,0.0541208810414,0.0506950844025,0.041997094827,0.0345540033384,0.0325231209787,0.0352060509936,0.0352060509936,0.0345540033384,0.0345540033384,0.0345540033384,0.0345540033384,0.0345540033384,0.0345540033384,0.0345540033384,0.0345540033384,0.0345540033384,0.0345540033384,0.0345540033384,0.0345540033384,0.0345540033384,0.0345540033384,0.0345540033384,0.0345540033384,0.0345540033384,0.0345540033384,0.0345540033384)
M_hpd_M95=c(1.50104094517, 1.50104094517,0.168370811712,0.168370811712,0.165284790526,0.165284790526,0.165284790526,0.165284790526,0.163743214878,0.157694475402,0.157694475402,0.156262041937,0.156262041937,0.156262041937,0.152820622076,0.152820622076,0.152820622076,0.152820622076,0.152820622076,0.152820622076,0.152820622076,0.152813115436,0.148342013677,0.142618745612,0.142141571108,0.136768885292,0.12245102333,0.114443288045,0.113433288869,0.113433288869,0.114443288045,0.116268572168,0.116268572168,0.114443288045,0.114443288045,0.114443288045,0.114443288045,0.114443288045,0.114443288045,0.114443288045,0.114443288045,0.114443288045,0.114443288045,0.114443288045,0.114443288045,0.114443288045,0.114443288045,0.114443288045,0.114443288045)
R_hpd_m95=c(-1.23410544524, -1.23410544524,0.0254876231569,0.0231583154962,-0.0223154352682,-0.0754573230122,-0.0903895169877,-0.085412790371,-0.0808364543292,-0.0805259011231,-0.0791391052204,-0.0791391052204,-0.0791391052204,-0.0791391052204,-0.0769372709811,-0.0655189831871,-0.0610953464456,-0.0610953464456,-0.0610953464456,-0.0554293428033,-0.0407122818653,-0.0366226560348,-0.0346701778926,-0.0280506081163,-0.0269433470937,-0.0239506439019,-0.00599435373452,0.0074522355999,-0.00599435373452,0.0212981808958,0.0242229211091,0.0387166080265,0.0554985129159,0.0554985129159,0.0570152432135,0.0570152432135,0.0570152432135,0.0570152432135,0.0465135737065,0.0465135737065,0.0465135737065,0.0465135737065,0.0535358376889,0.0437687878385,0.0523080918633,0.0437687878385,0.0437687878385,0.0437687878385,0.0437687878385)
R_hpd_M95=c(-0.555363872575, -0.555363872575,0.246023558614,0.246023558614,0.244443230093,0.200888652318,0.0604218087486,0.0337365078674,0.0323882937218,0.029287942105,0.0290126214476,0.0290126214476,0.0278851505299,0.0278851505299,0.0278851505299,0.0393963033603,0.0505130701645,0.0487822383302,0.0621041467564,0.0706526648373,0.0835198540235,0.0981155708442,0.114778022651,0.126235157811,0.130980354368,0.136183393667,0.138676976781,0.154011556942,0.150340347497,0.253921633173,0.278214259621,0.293454861071,0.297626261915,0.293454861071,0.336025271851,0.336025271851,0.336025271851,0.336025271851,0.336025271851,0.336025271851,0.336025271851,0.337948750052,0.354338250788,0.345194437982,0.378769056815,0.373879259867,0.373879259867,0.373879259867,0.373879259867)
L_mean=c(0.277589215713, 0.277589215713,0.277589215713,0.275779837283,0.25191073584,0.182849893457,0.1111363917,0.105938497783,0.105033936614,0.104681610596,0.104942432577,0.105101683669,0.105553409779,0.105763794222,0.106337455374,0.111940101846,0.115033843086,0.117393585454,0.121576769052,0.126914682989,0.135202824915,0.140586340517,0.141406364473,0.14499892302,0.145211235252,0.146237143916,0.146237143916,0.146684532873,0.14882452341,0.179266994942,0.224176762323,0.246779489483,0.252532761014,0.253817101365,0.267712710303,0.26852028957,0.268879831943,0.269540726548,0.270344559748,0.270536058479,0.270540152944,0.272891744108,0.276611194832,0.276222889669,0.280159546768,0.283576233695,0.283576233695,0.283576233695,0.283576233695)
M_mean=c(1.16750401738, 1.16750401738,0.129933932487,0.129933932487,0.129703510719,0.128702011995,0.128298166156,0.128164052218,0.126678836704,0.127099887955,0.127063203294,0.126544220511,0.127410001579,0.127185471691,0.124956809635,0.124746548012,0.124223698286,0.124262396641,0.124197424594,0.124558415105,0.124532872119,0.122145983307,0.111341664313,0.103721025049,0.0963812026093,0.0839942347704,0.0777307446877,0.0749974408069,0.0744540681788,0.0745158075147,0.0757545201614,0.076259751884,0.0764263755177,0.0760611386462,0.0760611386462,0.0760611386462,0.0760611386462,0.0760611386462,0.0760611386462,0.0760611386462,0.0760611386462,0.0760611386462,0.0760611386462,0.0760611386462,0.0760611386462,0.0760611386462,0.0760611386462,0.0760611386462,0.0760611386462)
R_mean=c(-0.889914801664, -0.889914801664,0.147655283226,0.145845904796,0.122207225122,0.0541478814616,-0.0171617744564,-0.0222255544355,-0.02164490009,-0.0224182773592,-0.0221207707172,-0.0214425368411,-0.0218565918,-0.0214216774686,-0.0186193542613,-0.012806446166,-0.00918985520058,-0.00686881118702,-0.00262065554239,0.00235626788434,0.0106699527955,0.0184403572106,0.0300647001598,0.0412778979712,0.0488300326429,0.0622429091452,0.0685063992279,0.0716870920657,0.0743704552311,0.104751187428,0.148422242162,0.170519737599,0.176106385496,0.177755962719,0.191651571657,0.192459150924,0.192818693297,0.193479587902,0.194283421101,0.194474919832,0.194479014297,0.196830605462,0.200550056186,0.200161751023,0.204098408121,0.207515095049,0.207515095049,0.207515095049,0.207515095049)
trans=0.5
age=(0:(49-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.471950663616), xlim = c(-51.45,2.45), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.65114503969), xlim = c(-51.45,2.45), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.35751598976, 0.416645962497), xlim = c(-51.45,2.45), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-51.45,2.45), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()